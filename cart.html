<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FutureWize – העגלה שלי</title>
    <link rel="stylesheet" href="designcss.css">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>

<body>

<!-- ========================== -->
<!--           NAVBAR           -->
<!-- ========================== -->

<header class="navbar">
  <div class="nav-right">
    <a href="index.html">
      <img src="images/logo image.jpg" alt="FutureWize Logo" class="logo-img">
    </a>

    <nav class="nav-links">
      <a href="index.html">בית</a>
      <a href="about.html">אודות</a>
      <a href="products.html">תוכניות</a>
      <a href="cart.html">העגלה שלי</a>
      <a href="contact.html">צור קשר</a>
    </nav>
  </div>

  <div class="nav-left">
    <span id="welcomeUser" style="color:white; font-size:16px; display:none;"></span>

    <button id="logoutBtn"
            onclick="logout()"
            style="display:none; background:none; border:none; color:var(--accent); cursor:pointer; font-weight:600;">
      התנתקות
    </button>

    <a href="login.html" id="loginBtn" class="nav-btn login-btn">התחברות</a>
    <a href="register.html" id="registerBtn" class="nav-btn register-btn">הרשמה</a>
  </div>
</header>

<!-- ========================== -->
<!--           CART PAGE        -->
<!-- ========================== -->

<main class="cart-page">

    <h1 class="cart-title">
        <i class="bi bi-cart4 cart-icon"></i>
        העגלה שלי
    </h1>

    <section class="cart-layout">

        <!-- LEFT: CART ITEMS -->
        <section class="cart-items" id="cartItems"></section>

        <!-- RIGHT: SUMMARY -->
        <aside class="cart-summary">
            <h2 class="summary-title">סיכום ההזמנה</h2>

            <p class="summary-label">סה״כ נבחר</p>
            <p class="summary-total" id="totalPrice">₪0</p>

            <p class="summary-note">
                התשלום מתבצע באמצעות תיאום מול נציג FutureWize
            </p>

            <button class="checkout-btn" onclick="contactRepresentative()">
                העברת פנייה לנציג
            </button>
        </aside>

    </section>

</main>

<!-- ========================== -->
<!--           FOOTER           -->
<!-- ========================== -->

<footer class="footer">
    <p>© 2025 FutureWize — חינוך פיננסי ויזמות לבתי ספר</p>
</footer>

<!-- ========================== -->
<!--            SCRIPT          -->
<!-- ========================== -->

<script src="auth.js"></script>

<script>
/* ============================= */
/*            DATA               */
/* ============================= */

const prices = {
    "סדנת יזמות – כיתתית": 2000,
    "סדנת חינוך פיננסי – כיתתית": 2000,
    "סדנת יזמות – שכבתית": 6000,
    "סדנת חינוך פיננסי – שכבתית": 6000,
    "תחרות חדשנות / האקתון": 10000
};

let cart = JSON.parse(localStorage.getItem("cart")) || [];
let selectedItems = [...cart];

const cartItemsEl = document.getElementById("cartItems");
const totalPriceEl = document.getElementById("totalPrice");

/* ============================= */
/*         RENDER CART           */
/* ============================= */

function renderCart() {
    cartItemsEl.innerHTML = "";
    let total = 0;

    if (cart.length === 0) {
        cartItemsEl.innerHTML = "<p class='empty-cart'>העגלה ריקה</p>";
        totalPriceEl.textContent = "₪0";
        return;
    }

    cart.forEach((item, index) => {
        const price = prices[item] || 0;
        const isChecked = selectedItems.includes(item);

        if (isChecked) total += price;

        cartItemsEl.innerHTML += `
            <div class="cart-row">
                <input type="checkbox"
                       ${isChecked ? "checked" : ""}
                       onchange="toggleItem('${item}')">

                <span class="cart-item-name">${item}</span>

                <span class="cart-price">
                    ₪${price.toLocaleString()}
                </span>

                <button class="remove-btn" onclick="removeItem(${index})">✕</button>
            </div>
        `;
    });

    totalPriceEl.textContent = `₪${total.toLocaleString()}`;
}

/* ============================= */
/*      CART INTERACTIONS        */
/* ============================= */

function toggleItem(item) {
    if (selectedItems.includes(item)) {
        selectedItems = selectedItems.filter(i => i !== item);
    } else {
        selectedItems.push(item);
    }
    renderCart();
}

function removeItem(index) {
    const removedItem = cart[index];
    cart.splice(index, 1);
    selectedItems = selectedItems.filter(i => i !== removedItem);
    localStorage.setItem("cart", JSON.stringify(cart));
    renderCart();
}

function contactRepresentative() {
    if (selectedItems.length === 0) {
        alert("לא נבחרו תכניות לפנייה");
        return;
    }

    let message =
`שלום,

אני מעוניין/ת לקבל פרטים ולתאם תשלום עבור התכניות הבאות:

`;

    let total = 0;

    selectedItems.forEach(item => {
        const price = prices[item] || 0;
        total += price;
        message += `- ${item} (₪${price.toLocaleString()})\n`;
    });

    message += `\nסה״כ משוער: ₪${total.toLocaleString()}\n\nתודה!`;

    window.location.href =
        `mailto:info@futurewize.co.il?subject=פנייה להזמנת סדנאות&body=${encodeURIComponent(message)}`;
}

renderCart();
</script>

</body>
</html>
